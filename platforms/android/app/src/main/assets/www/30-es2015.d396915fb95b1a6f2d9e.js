(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{PMNr:function(t,e,o){"use strict";o.r(e),o.d(e,"AddNewAddressPageModule",function(){return k});var i=o("ofXK"),n=o("3Pt+"),s=o("TEn/"),a=o("tyNb"),r=o("mrSG"),l=o("WOgW"),d=o("Bfh1"),c=o("8RPc"),h=o("2Rin"),g=o("fXoL");const m=["map"],u=["autocompletesearch"];function b(t,e){if(1&t){const t=g.Wb();g.Vb(0,"ion-button",20),g.dc("click",function(){return g.uc(t),g.hc().addAddress()}),g.Ac(1," A\xf1adir "),g.Ub()}}function p(t,e){if(1&t){const t=g.Wb();g.Vb(0,"ion-button",20),g.dc("click",function(){return g.uc(t),g.hc().updateAddress()}),g.Ac(1," Actualizar "),g.Ub()}}const f=[{path:"",component:(()=>{class t{constructor(t,e,o,i,n,s,a,r){this.platform=t,this.androidPermissions=e,this.geolocation=o,this.navCtrl=i,this.api=n,this.util=s,this.route=a,this.router=r,this.house="",this.landmark="",this.title="home",this.autocompleteItems1=[],this.route.queryParams.subscribe(t=>{if(t&&t.from){this.from="edit";const e=JSON.parse(t.data);this.address=e.address,this.house=e.house,this.id=e.id,this.landmark=e.landmark,this.lat=e.lat,this.lng=e.lng,this.loadmap(this.lat,this.lng,this.mapEle)}else this.from="new",this.getLocation()})}ngOnInit(){return Object(r.a)(this,void 0,void 0,function*(){})}ionViewWillEnter(){let t=document.getElementById("googlePlaces").getElementsByTagName("input")[0],e=new google.maps.places.Autocomplete(t,{fields:["geometry","icon","name"],strictBounds:!1});google.maps.event.addListener(e,"place_changed",()=>{let t=e.getPlace();const o=new google.maps.LatLng(t.geometry.location.lat(),t.geometry.location.lng());this.lat=t.geometry.location.lat(),this.lng=t.geometry.location.lng(),this.addMarker(o),this.map.setCenter(o)})}getLocation(){this.platform.ready().then(()=>{this.platform.is("android")?(this.androidPermissions.checkPermission(this.androidPermissions.PERMISSION.ACCESS_FINE_LOCATION).then(t=>console.log("Has permission?",t.hasPermission),t=>this.androidPermissions.requestPermission(this.androidPermissions.PERMISSION.ACCESS_FINE_LOCATION)),this.grantRequest()):this.platform.is("ios")?this.grantRequest():this.geolocation.getCurrentPosition({maximumAge:3e3,timeout:1e4,enableHighAccuracy:!1}).then(t=>{t&&(this.lat=t.coords.latitude,this.lng=t.coords.longitude,this.loadmap(t.coords.latitude,t.coords.longitude,this.mapEle),this.getAddress(this.lat,this.lng))})})}onSearchChange(t){return Object(r.a)(this,void 0,void 0,function*(){this.GoogleAutocomplete.getPlacePredictions({input:this.address},(t,e)=>{t&&t.length>0&&(this.autocompleteItems1=t)})})}grantRequest(){this.geolocation.getCurrentPosition({maximumAge:3e3,timeout:1e4,enableHighAccuracy:!1}).then(t=>{t&&(this.loadmap(t.coords.latitude,t.coords.longitude,this.mapEle),this.getAddress(t.coords.latitude,t.coords.longitude))})}loadmap(t,e,o){const i=new google.maps.LatLng(t,e),n={zoom:15,scaleControl:!1,streetViewControl:!1,zoomControl:!1,overviewMapControl:!1,center:i,mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"Foodfire5"]}};this.map=new google.maps.Map(o.nativeElement,n);const s=new google.maps.StyledMapType([{featureType:"all",elementType:"all",stylers:[{saturation:-100}]}],{name:"Grayscale"});this.map.mapTypes.set("Foodfire5",s),this.map.setMapTypeId("Foodfire5"),this.addMarker(i)}getAddress(t,e){const o=new google.maps.Geocoder,i=new google.maps.LatLng(t,e);o.geocode({location:i},(o,i)=>{this.address=o[0].formatted_address,this.lat=t,this.lng=e})}addMarker(t){null!=this.marker&&this.marker.setMap(null);const e={url:"assets/icon/marker.png",scaledSize:new google.maps.Size(50,50)};this.marker=new google.maps.Marker({position:t,map:this.map,icon:e,draggable:!0,animation:google.maps.Animation.DROP}),google.maps.event.addListener(this.marker,"dragend",()=>{this.getDragAddress(this.marker)})}getDragAddress(t){const e=new google.maps.Geocoder,o=new google.maps.LatLng(t.position.lat(),t.position.lng());e.geocode({location:o},(e,o)=>{this.address=e[0].formatted_address,this.lat=t.position.lat(),this.lng=t.position.lng()})}addAddress(){if(""===this.address||""===this.landmark||""===this.house)return this.util.errorToast(this.util.translate("Todos los campos son requerido")),!1;this.util.show();const t={uid:localStorage.getItem("uid"),address:this.address,lat:this.lat,lng:this.lng,title:this.title,house:this.house,landmark:this.landmark};this.api.post("address/save",t).then(t=>{this.util.hide(),t&&200===t.status?(this.util.publishAddress(""),this.navCtrl.back(),this.util.showToast("Direccion agregada","success","bottom")):this.util.errorToast("Algo ha ido mal")},t=>{this.util.hide(),this.util.errorToast("Algo ha ido mal")})}updateAddress(){if(""===this.address||""===this.landmark||""===this.house)return this.util.errorToast("Todos los campos son requeridos"),!1;this.util.show();const t={id:this.id,uid:localStorage.getItem("uid"),address:this.address,lat:this.lat,lng:this.lng,title:this.title,house:this.house,landmark:this.landmark};this.api.post("address/editList",t).then(t=>{this.util.hide(),t&&200===t.status?(this.util.publishAddress(""),this.navCtrl.back(),this.util.showToast("Direcci\xf3n actualizada","success","bottom")):this.util.errorToast("Algo ha ido mal")},t=>{this.util.hide(),this.util.errorToast("Algo ha ido mal")})}}return t.\u0275fac=function(e){return new(e||t)(g.Qb(s.gb),g.Qb(l.a),g.Qb(d.a),g.Qb(s.db),g.Qb(c.a),g.Qb(h.a),g.Qb(a.a),g.Qb(a.g))},t.\u0275cmp=g.Kb({type:t,selectors:[["app-add-new-address"]],viewQuery:function(t,e){if(1&t&&(g.Fc(m,3),g.Fc(u,3)),2&t){let t;g.sc(t=g.ec())&&(e.mapEle=t.first),g.sc(t=g.ec())&&(e.autoCompleteS=t.first)}},decls:44,vars:6,consts:[["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back"],[1,"div_map"],["map",""],[1,"informations"],["position","stacked"],["id","googlePlaces",3,"ngModel","ngModelChange"],["autocompletesearch",""],[3,"ngModel","ngModelChange"],["mode","md",3,"ngModel","ngModelChange"],[1,"title"],[2,"margin-top","20px"],["name","home-outline","slot","start"],["value","casa"],["name","briefcase-outline","slot","start"],["value","oficina"],["name","navigate-outline","slot","start"],["value","otro"],["expand","block",3,"click",4,"ngIf"],["expand","block",3,"click"]],template:function(t,e){1&t&&(g.Vb(0,"ion-header"),g.Vb(1,"ion-toolbar"),g.Vb(2,"ion-buttons",0),g.Vb(3,"ion-button",1),g.dc("click",function(){return e.util.back()}),g.Rb(4,"ion-icon",2),g.Ub(),g.Ub(),g.Vb(5,"ion-title"),g.Ac(6,"A\xf1adir nueva direcci\xf3n"),g.Ub(),g.Ub(),g.Ub(),g.Vb(7,"ion-content"),g.Rb(8,"div",3,4),g.Vb(10,"div",5),g.Vb(11,"ion-item"),g.Vb(12,"ion-label",6),g.Ac(13,"Ubicaci\xf3n"),g.Ub(),g.Vb(14,"ion-input",7,8),g.dc("ngModelChange",function(t){return e.address=t}),g.Ub(),g.Ub(),g.Vb(16,"ion-item"),g.Vb(17,"ion-label",6),g.Ac(18,"N\xfamero de casa"),g.Ub(),g.Vb(19,"ion-input",9),g.dc("ngModelChange",function(t){return e.house=t}),g.Ub(),g.Ub(),g.Vb(20,"ion-item"),g.Vb(21,"ion-label",6),g.Ac(22,"Punto de referencia"),g.Ub(),g.Vb(23,"ion-input",9),g.dc("ngModelChange",function(t){return e.landmark=t}),g.Ub(),g.Ub(),g.Vb(24,"ion-radio-group",10),g.dc("ngModelChange",function(t){return e.title=t}),g.Vb(25,"ion-label",11),g.Ac(26," Guardar como "),g.Ub(),g.Vb(27,"ion-item",12),g.Rb(28,"ion-icon",13),g.Vb(29,"ion-label"),g.Ac(30,"Casa"),g.Ub(),g.Rb(31,"ion-radio",14),g.Ub(),g.Vb(32,"ion-item"),g.Rb(33,"ion-icon",15),g.Vb(34,"ion-label"),g.Ac(35,"Oficina"),g.Ub(),g.Rb(36,"ion-radio",16),g.Ub(),g.Vb(37,"ion-item"),g.Rb(38,"ion-icon",17),g.Vb(39,"ion-label"),g.Ac(40,"Otro"),g.Ub(),g.Rb(41,"ion-radio",18),g.Ub(),g.Ub(),g.zc(42,b,2,0,"ion-button",19),g.zc(43,p,2,0,"ion-button",19),g.Ub(),g.Ub()),2&t&&(g.Fb(14),g.nc("ngModel",e.address),g.Fb(5),g.nc("ngModel",e.house),g.Fb(4),g.nc("ngModel",e.landmark),g.Fb(1),g.nc("ngModel",e.title),g.Fb(18),g.nc("ngIf","new"===e.from),g.Fb(1),g.nc("ngIf","edit"===e.from))},directives:[s.s,s.X,s.h,s.g,s.t,s.W,s.m,s.v,s.w,s.u,s.kb,n.h,n.k,s.A,s.jb,s.z,s.ib,i.j],styles:[".div_map[_ngcontent-%COMP%]{height:50vh;width:100%;border:1px solid gray}.informations[_ngcontent-%COMP%]{padding:16px}.informations[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start:0px}.informations[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:gray}.informations[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:block;font-weight:700;margin-top:15px}.informations[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius:5px;margin-top:20px}"]}),t})()}];let A=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.Ob({type:t}),t.\u0275inj=g.Nb({imports:[[a.i.forChild(f)],a.i]}),t})(),k=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.Ob({type:t}),t.\u0275inj=g.Nb({imports:[[i.b,n.e,s.Y,A]]}),t})()}}]);