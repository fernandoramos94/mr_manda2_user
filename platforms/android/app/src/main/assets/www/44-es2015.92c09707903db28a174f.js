(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{"rt+D":function(t,e,o){"use strict";o.r(e),o.d(e,"PickLocationPageModule",function(){return v});var i=o("ofXK"),n=o("3Pt+"),s=o("TEn/"),a=o("tyNb"),c=o("mrSG"),l=o("WOgW"),r=o("Bfh1"),d=o("mtRb"),h=o("2Rin"),u=o("yHma"),g=o("fXoL");const p=["map"];function m(t,e){if(1&t){const t=g.Wb();g.Vb(0,"ion-item",2),g.dc("click",function(){g.uc(t);const o=e.$implicit;return g.hc().selectSearchResult1(o)}),g.Ac(1),g.Rb(2,"ion-ripple-effect",11),g.Ub()}if(2&t){const t=e.$implicit;g.Fb(1),g.Cc(" ",t.description," ")}}function b(t,e){if(1&t){const t=g.Wb();g.Vb(0,"div",12),g.Vb(1,"ion-button",13),g.dc("click",function(){return g.uc(t),g.hc().selectedAddress()}),g.Ac(2," Usar esta ubicaci\xf3n "),g.Ub(),g.Ub()}}const f=[{path:"",component:(()=>{class t{constructor(t,e,o,i,n,s,a,c,l,r,d){this.chMod=t,this.platform=e,this.androidPermissions=o,this.geolocation=i,this.router=n,this.util=s,this.alertController=a,this.navCtrl=c,this.menuController=l,this.diagnostic=r,this.locationService=d,this.autocompleteItems1=[],this.GoogleAutocomplete=new google.maps.places.AutocompleteService,this.geocoder=new google.maps.Geocoder,this.autocomplete1={query:""},this.autocompleteItems1=[]}loadMap(t,e){this.lat=t,this.lng=e;const o=new google.maps.LatLng(t,e),i={center:o,zoom:15,scaleControl:!0,streetViewControl:!1,zoomControl:!1,overviewMapControl:!1,mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,disableDoubleClickZoom:!1,styles:[]};this.map=new google.maps.Map(this.mapElement.nativeElement,i),this.previousMarker=new google.maps.Marker({position:o,map:this.map,animation:google.maps.Animation.DROP,title:"Your Location"})}ngOnInit(){}close(){this.navCtrl.back()}getLocation(){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.locationService.getLocationCoordinates();t&&this.getAddress(t.lat,t.lng)})}askPermission(){this.getLocation()}grantRequest(){this.diagnostic.isLocationEnabled().then(t=>{t||this.diagnostic.switchToSettings(),this.geolocation.getCurrentPosition({maximumAge:3e3,timeout:1e4,enableHighAccuracy:!1}).then(t=>{t&&(this.lat=t.coords.latitude,this.lng=t.coords.longitude,this.getAddress(t.coords.latitude,t.coords.longitude))}).catch(t=>{this.diagnostic.switchToSettings()})},t=>{this.platform.is("ios")?this.iOSAlert():this.presentAlertConfirm()}).catch(t=>{this.platform.is("ios")?this.iOSAlert():this.presentAlertConfirm()})}getAddress(t,e){const o=new google.maps.Geocoder,i=new google.maps.LatLng(t,e);o.geocode({location:i},(o,i)=>{o&&o.length?(this.lat=t,this.lng=e,localStorage.setItem("location","true"),localStorage.setItem("lat",this.lat),localStorage.setItem("address",o[0].formatted_address),localStorage.setItem("lng",this.lng),this.util.cityAddress=o[0].formatted_address,this.util.publishLocation(),this.navCtrl.navigateRoot([""])):this.util.errorToast("Something went wrong please try again later")})}iOSAlert(){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"Alert",message:"Por favor activa tu ubicaci\xf3n para una mejor experiencia",buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Ok",handler:()=>{this.diagnostic.switchToSettings()}}]});yield t.present()})}presentAlertConfirm(){return Object(c.a)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"Alert",message:"Please Enable Location Service for best experience",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Okay",handler:()=>{this.askPermission()}}]});yield t.present()})}selectedAddress(){localStorage.setItem("location","true"),localStorage.setItem("lat",this.lat),localStorage.setItem("lng",this.lng),localStorage.setItem("address",this.autocomplete1.query),this.util.publishLocation(),this.navCtrl.navigateRoot([""])}onSearchChange(t){return Object(c.a)(this,void 0,void 0,function*(){if(""===this.autocomplete1.query)return void(this.autocompleteItems1=[]);const t=localStorage.getItem("addsSelected");t&&null!=t?localStorage.removeItem("addsSelected"):this.GoogleAutocomplete.getPlacePredictions({input:this.autocomplete1.query},(t,e)=>{t&&t.length>0&&(this.autocompleteItems1=t)})})}selectSearchResult1(t){localStorage.setItem("addsSelected","true"),this.autocompleteItems1=[],this.autocomplete1.query=t.description,this.util.cityAddress=t.description,this.geocoder.geocode({placeId:t.place_id},(t,e)=>{"OK"===e&&t[0]&&(this.lat=t[0].geometry.location.lat(),this.lng=t[0].geometry.location.lng(),this.chMod.detectChanges(),this.loadMap(this.lat,this.lng))})}ionViewWillEnter(){this.menuController.enable(!1)}ionViewWillLeave(){this.menuController.enable(!0)}}return t.\u0275fac=function(e){return new(e||t)(g.Qb(g.i),g.Qb(s.gb),g.Qb(l.a),g.Qb(r.a),g.Qb(a.g),g.Qb(h.a),g.Qb(s.b),g.Qb(s.db),g.Qb(s.bb),g.Qb(d.a),g.Qb(u.a))},t.\u0275cmp=g.Kb({type:t,selectors:[["app-pick-location"]],viewQuery:function(t,e){if(1&t&&g.Fc(p,3),2&t){let t;g.sc(t=g.ec())&&(e.mapElement=t.first)}},decls:17,vars:5,consts:[["mode","ios"],["slot","end"],[3,"click"],["slot","icon-only","name","close-circle-outline"],["select-all","","mode","ios",3,"placeholder","debounce","ngModel","ionChange","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["expand","block","fill","clear","shape","round","color","primary",3,"click"],[1,"ion-text-center"],["id","map",1,"map"],["map",""],["style","margin-top: 20px;padding: 30px;",4,"ngIf"],["type","bounded"],[2,"margin-top","20px","padding","30px"],["expand","block","shape","round","color","primary",3,"click"]],template:function(t,e){1&t&&(g.Vb(0,"ion-header",0),g.Vb(1,"ion-toolbar"),g.Vb(2,"ion-title"),g.Ac(3,"Buscar ubicaci\xf3n"),g.Ub(),g.Vb(4,"ion-buttons",1),g.Vb(5,"ion-button",2),g.dc("click",function(){return e.close()}),g.Rb(6,"ion-icon",3),g.Ub(),g.Ub(),g.Ub(),g.Ub(),g.Vb(7,"ion-content"),g.Vb(8,"ion-searchbar",4),g.dc("ionChange",function(t){return e.onSearchChange(t)})("ngModelChange",function(t){return e.autocomplete1.query=t}),g.Ub(),g.Vb(9,"ion-list"),g.zc(10,m,3,1,"ion-item",5),g.Ub(),g.Vb(11,"ion-button",6),g.dc("click",function(){return e.getLocation()}),g.Ac(12," Usar mi ubicaci\xf3n actual "),g.Ub(),g.Rb(13,"p",7),g.Rb(14,"div",8,9),g.zc(16,b,3,0,"div",10),g.Ub()),2&t&&(g.Fb(8),g.nc("placeholder","Buscar ubicaci\xf3n")("debounce",250)("ngModel",e.autocomplete1.query),g.Fb(2),g.nc("ngForOf",e.autocompleteItems1),g.Fb(6),g.nc("ngIf",e.lat&&e.lng))},directives:[s.s,s.X,s.W,s.h,s.g,s.t,s.m,s.G,s.kb,n.h,n.k,s.x,i.i,i.j,s.v,s.D],styles:[".btnb[_ngcontent-%COMP%]{padding:10px;display:flex;flex-direction:row;justify-content:flex-start;align-items:center;border-bottom:1px solid #d3d3d3;position:relative;overflow:hidden}#map[_ngcontent-%COMP%]{margin-top:20px;width:100%;height:300px}"]}),t})()}];let y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.Ob({type:t}),t.\u0275inj=g.Nb({imports:[[a.i.forChild(f)],a.i]}),t})(),v=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.Ob({type:t}),t.\u0275inj=g.Nb({imports:[[i.b,n.e,s.Y,y]]}),t})()}}]);